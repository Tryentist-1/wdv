# App Feature Plan: Archer Profile

This document outlines the design, data models, and logic for an "Archer Profile" page, which serves as a central hub for an archer's career statistics and achievements within the app.

## Phase 1: New Data Model (`Award`)

To properly display achievements, we must store the awards an archer wins. This data is generated by the "Calculate Awards" logic in the `event_feature_plan.md` (Phase 6).

### Data Model: `Award`

* `Award_ID`: (Unique ID)
* `Archer_ID`: (Links to `Archer`. For team awards, this is the `School_ID` or each `Archer_ID` on the team).
* `Event_ID`: (Links to `Event`)
* `Award_Name`: (String, e.g., "1st Place, Boys Varsity Ranking Round")
* `Award_Type`: (String, e.g., `Gold_Medal`, `Silver_Medal`, `Bronze_Medal`, `Champion_Trophy`)
* `Division`: (String: `BV`, `BJV`, `GV`, `GJV`)
* `Competition_Type`: (String: `Ranking`, `Solo_Elim`, `Team_Elim`, `Overall_School`)

## Phase 2: Archer Profile Page (UI Design)

This is the public-facing (or user-facing) profile for a single archer.

### Section 1: Archer Header

This area contains the archer's static information.

* **Archer Name:** (e.g., "Alex Johnson")
* **School:** (e.g., "Main Street High School")
* **Current Division:** (e.g., "Boys Varsity")
* *(Optional: Profile Picture)*

### Section 2: Career Stats Overview (Calculated)

This is the "at-a-glance" box with their most important career stats, aggregated from all events they've participated in.

* **Career Best (Ranking):** 345
* **Career Avg (Ranking):** 312.5
* **Total 10s (Career):** 122
* **Solo Match Record:** 8-2 (W-L)
* **Team Match Record:** 4-1 (W-L)
* **Shoot-Off Record:** 2-0 (W-L)
* **Events Attended:** 6

### Section 3: Career Achievements & Awards

This section dynamically lists all `Award` records associated with this `Archer_ID`.

* **ü•á 1st Place (BV Solo)** - *OAS CA State Championship 2025*
* **üèÜ 1st Place (BV Team)** - *OAS CA State Championship 2025*
* **ü•á 1st Place (BV Ranking)** - *OAS CA State Championship 2025*
* **ü•â 3rd Place (BV Solo)** - *Conference Finals 2024*

### Section 4: Event History (Log)

This is a detailed, reverse-chronological list of every event the archer has attended, showing their performance in each.

**OAS CA State Championship 2025 (BV)**
* **Ranking:** 1st / 64 (Score: 345)
* **Solo Elim:** 1st Place (4-0)
* **Team Elim:** 1st Place (3-0)

**Conference Finals 2024 (BV)**
* **Ranking:** 5th / 32 (Score: 310)
* **Solo Elim:** 3rd Place (2-1)
* **Team Elim:** 2nd Place (1-1)

**Mail-In Tournament Fall 2024 (BV)**
* **Ranking:** 12th / 150 (Score: 302)

---

## Phase 3: Backend Calculation Logic

This is how the "Career Stats Overview" (Section 2) is calculated. These queries run when a user loads the profile page.

* **`Career_Best (Ranking)`:**
    * `SELECT MAX(Total_Score) FROM Ranking_Scorecard WHERE Archer_ID = [Current_Archer_ID]`

* **`Career_Avg (Ranking)`:**
    * `SELECT AVG(Total_Score) FROM Ranking_Scorecard WHERE Archer_ID = [Current_Archer_ID]`
    * *(Note: This is the archer's *actual* performance average, which is more accurate than the coach-provided `RRA` in the `Archer` table, which is just for initial seeding.)*

* **`Total_10s (Career)`:**
    * `SELECT SUM(Total_10s) FROM Ranking_Scorecard WHERE Archer_ID = [Current_Archer_ID]`

* **`Solo_Match_Record (W-L)`:**
    * **Wins:** `SELECT COUNT(Match_ID) FROM Elimination_Match`
        * `WHERE (Competitor_1_ID = [Current_Archer_ID] OR Competitor_2_ID = [Current_Archer_ID])`
        * `AND Winner_ID = [Current_Archer_ID]`
        * `AND Bracket_ID IN (SELECT Bracket_ID FROM Bracket WHERE Bracket_Type = 'Solo')`
    * **Losses:** `SELECT COUNT(Match_ID) FROM Elimination_Match`
        * `WHERE (Competitor_1_ID = [Current_Archer_ID] OR Competitor_2_ID = [Current_Archer_ID])`
        * `AND Winner_ID != [Current_Archer_ID] AND Winner_ID IS NOT NULL`
        * `AND Bracket_ID IN (SELECT Bracket_ID FROM Bracket WHERE Bracket_Type = 'Solo')`

* **`Team_Match_Record (W-L)`:**
    * *This requires joining `Elimination_Match` with `Bracket` (for `Bracket_Type = 'Team'`) and `Archer` (for `School_ID`).*
    * **Wins:** `SELECT COUNT(Match_ID) FROM Elimination_Match M`
        * `JOIN Bracket B ON M.Bracket_ID = B.Bracket_ID`
        * `JOIN School S ON (M.Competitor_1_ID = S.School_ID OR M.Competitor_2_ID = S.School_ID)`
        * `WHERE B.Bracket_Type = 'Team'`
        * `AND S.School_ID = [Current_Archers_School_ID]`
        * `AND M.Winner_ID = [Current_Archers_School_ID]`
        * `AND M.Event_ID IN (SELECT Event_ID FROM Event_Registration WHERE Archer_ID = [Current_Archer_ID])`
        * *(This query ensures we only count team matches for events the archer actually attended).*
    * **Losses:** (Same query, but `M.Winner_ID != [Current_Archers_School_ID]`)

* **`Shoot-Off_Record (W-L)`:**
    * This logic would be similar to the Match Record logic, but would also check if the `ShootOff_Score` field was used.