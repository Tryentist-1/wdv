<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>OAS Score & Tools</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'score-gold': '#FFD700',
            'score-red': '#EF4444',
            'score-blue': '#3B82F6',
            'score-black': '#1F2937',
            'score-white': '#F9FAFB',
            'brand-green': '#10B981',
            'brand-blue': '#3B82F6',
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Minimal custom CSS - onboarding modal step visibility */
    .onboarding-step {
      display: none;
    }
    .onboarding-step.active {
      display: block;
    }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen flex items-center justify-center p-4 transition-colors duration-200">
  <!-- Onboarding Modal -->
  <div id="onboarding-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full max-h-[95vh] overflow-y-auto shadow-2xl transition-colors duration-200">
      <!-- Step 1: Welcome -->
      <div id="step-1" class="onboarding-step active">
        <div class="flex justify-center gap-1 mb-4">
          <div class="w-2.5 h-2.5 rounded-full bg-blue-600 dark:bg-blue-500"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
        </div>
        <h2 class="text-xl font-bold text-blue-600 dark:text-blue-400 mb-3">
          <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-600 dark:bg-blue-500 text-white text-sm mr-2">1</span>
          Welcome to Archery Tools!
        </h2>
        <p class="text-gray-600 dark:text-gray-300 mb-4 text-sm leading-relaxed">This app helps you score archery rounds and manage your team. Let's get you set up in just a few steps.</p>
        
        <div class="text-center my-4">
          <img src="data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='250' height='160' viewBox='0 0 250 160'><rect width='250' height='160' fill='%23f8f9fa' stroke='%23dee2e6' stroke-width='1'/><text x='125' y='25' text-anchor='middle' font-family='Arial' font-size='14' fill='%23343a40'>üèπ Archery Tools</text><rect x='15' y='40' width='100' height='30' rx='4' fill='%23198754' stroke='%23fff' stroke-width='1'/><text x='65' y='60' text-anchor='middle' font-family='Arial' font-size='10' fill='%23fff'>üë• Setup</text><rect x='125' y='40' width='100' height='30' rx='4' fill='%232a9d8f' stroke='%23fff' stroke-width='1'/><text x='175' y='60' text-anchor='middle' font-family='Arial' font-size='10' fill='%23fff'>üèÜ Rank</text><rect x='15' y='80' width='100' height='30' rx='4' fill='%23e9c46a' stroke='%23fff' stroke-width='1'/><text x='65' y='100' text-anchor='middle' font-family='Arial' font-size='10' fill='%23343a40'>üë• Solo</text><rect x='125' y='80' width='100' height='30' rx='4' fill='%23f4a261' stroke='%23fff' stroke-width='1'/><text x='175' y='100' text-anchor='middle' font-family='Arial' font-size='10' fill='%23343a40'>üë•üë• Team</text><rect x='15' y='120' width='100' height='30' rx='4' fill='%23e76f51' stroke='%23fff' stroke-width='1'/><text x='65' y='140' text-anchor='middle' font-family='Arial' font-size='10' fill='%23fff'>üéØ Practice</text><line x1='125' y1='10' x2='125' y2='150' stroke='%23ff6b6b' stroke-width='2'/><text x='145' y='80' font-family='Arial' font-size='8' fill='%23ff6b6b'>Start!</text></svg>" alt="Main app interface" class="w-full max-w-xs mx-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
        </div>
        
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-trophy"></i> Ranking Rounds</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Score competitive ranking rounds with multiple archers</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-user-friends"></i> Solo & Team Matches</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Track head-to-head matches and team competitions</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-bullseye"></i> Practice Sessions</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Analyze your arrow grouping and improve accuracy</p>
        </div>
        <div class="flex gap-3 justify-center mt-6">
          <button class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="nextStep()">Get Started</button>
          <button class="px-5 py-2.5 bg-gray-500 hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-700 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="skipOnboarding()">Skip Tutorial</button>
        </div>
      </div>

      <!-- Step 2: Find Yourself -->
      <div id="step-2" class="onboarding-step">
        <div class="flex justify-center gap-1 mb-4">
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-blue-600 dark:bg-blue-500"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
        </div>
        <h2 class="text-xl font-bold text-blue-600 dark:text-blue-400 mb-3">
          <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-600 dark:bg-blue-500 text-white text-sm mr-2">2</span>
          Find Yourself & Bale Mates
        </h2>
        <p class="text-gray-600 dark:text-gray-300 mb-4 text-sm leading-relaxed">First, let's make sure you and your teammates are in the system. You'll need to:</p>
        
        <div class="text-center my-4">
          <img src="data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='250' height='180' viewBox='0 0 250 180'><rect width='250' height='180' fill='%23f8f9fa' stroke='%23dee2e6' stroke-width='1'/><text x='125' y='20' text-anchor='middle' font-family='Arial' font-size='12' fill='%23343a40'>üë• Archer Setup</text><rect x='10' y='30' width='230' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='20' y='45' font-family='Arial' font-size='10' fill='%23343a40'>üîç Search...</text><rect x='10' y='60' width='230' height='20' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='72' font-family='Arial' font-size='8' fill='%23ffc107'>‚≠ê</text><text x='25' y='72' font-family='Arial' font-size='8' fill='%23343a40'>Sarah J</text><text x='150' y='72' font-family='Arial' font-size='6' fill='%236c757d'>Bale 2 A</text><rect x='10' y='85' width='230' height='20' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='97' font-family='Arial' font-size='8' fill='%23ccc'>‚òÜ</text><text x='25' y='97' font-family='Arial' font-size='8' fill='%23343a40'>Mike C</text><text x='150' y='97' font-family='Arial' font-size='6' fill='%236c757d'>Bale 2 B</text><rect x='10' y='110' width='230' height='20' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='122' font-family='Arial' font-size='8' fill='%23ccc'>‚òÜ</text><text x='25' y='122' font-family='Arial' font-size='8' fill='%23343a40'>Alex R</text><text x='150' y='122' font-family='Arial' font-size='6' fill='%236c757d'>Bale 2 C</text><rect x='10' y='135' width='230' height='20' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='147' font-family='Arial' font-size='8' fill='%23ccc'>‚òÜ</text><text x='25' y='147' font-family='Arial' font-size='8' fill='%23343a40'>Emma D</text><text x='150' y='147' font-family='Arial' font-size='6' fill='%236c757d'>Bale 2 D</text><line x1='40' y1='72' x2='40' y2='72' stroke='%23ff6b6b' stroke-width='2'/><text x='50' y='68' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text><line x1='40' y1='97' x2='40' y2='97' stroke='%23ff6b6b' stroke-width='2'/><text x='50' y='93' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text><line x1='40' y1='122' x2='40' y2='122' stroke='%23ff6b6b' stroke-width='2'/><text x='50' y='118' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text><line x1='40' y1='147' x2='40' y2='147' stroke='%23ff6b6b' stroke-width='2'/><text x='50' y='143' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text></svg>" alt="Archer setup interface" class="w-full max-w-xs mx-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
        </div>
        
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-users"></i> Archer Setup</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Add yourself and your teammates to the archer list</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-star"></i> Mark Favorites</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Star your teammates so they appear at the top of the list</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-sync-alt"></i> Sync with Master List</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Import the latest archer list from your coach</p>
        </div>
        <div class="flex gap-3 justify-center mt-6">
          <button class="px-5 py-2.5 bg-gray-500 hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-700 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="prevStep()">Back</button>
          <button class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="nextStep()">Continue</button>
        </div>
      </div>

      <!-- Step 3: Sync Archer List -->
      <div id="step-3" class="onboarding-step">
        <div class="flex justify-center gap-1 mb-4">
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-blue-600 dark:bg-blue-500"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
        </div>
        <h2 class="text-xl font-bold text-blue-600 dark:text-blue-400 mb-3">
          <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-600 dark:bg-blue-500 text-white text-sm mr-2">3</span>
          Sync Your Archer List
        </h2>
        <p class="text-gray-600 dark:text-gray-300 mb-4 text-sm leading-relaxed">Keep your archer list up to date with the latest information from your coach:</p>
        
        <div class="text-center my-4">
          <img src="data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='250' height='140' viewBox='0 0 250 140'><rect width='250' height='140' fill='%23f8f9fa' stroke='%23dee2e6' stroke-width='1'/><text x='125' y='20' text-anchor='middle' font-family='Arial' font-size='12' fill='%23343a40'>üë• Archer List</text><rect x='10' y='30' width='230' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='20' y='45' font-family='Arial' font-size='10' fill='%23343a40'>üîç Search...</text><rect x='10' y='60' width='110' height='25' rx='3' fill='%236c757d' stroke='%23fff' stroke-width='1'/><text x='65' y='75' text-anchor='middle' font-family='Arial' font-size='8' fill='%23fff'>Sort Name</text><rect x='130' y='60' width='110' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='185' y='75' text-anchor='middle' font-family='Arial' font-size='8' fill='%23343a40'>Sort Bale</text><rect x='10' y='90' width='230' height='20' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='102' font-family='Arial' font-size='8' fill='%23ffc107'>‚≠ê</text><text x='25' y='102' font-family='Arial' font-size='8' fill='%23343a40'>Sarah J</text><text x='150' y='102' font-family='Arial' font-size='6' fill='%236c757d'>Bale 2 A</text><rect x='10' y='115' width='230' height='20' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='127' font-family='Arial' font-size='8' fill='%23ffc107'>‚≠ê</text><text x='25' y='127' font-family='Arial' font-size='8' fill='%23343a40'>Mike C</text><text x='150' y='127' font-family='Arial' font-size='6' fill='%236c757d'>Bale 2 B</text><rect x='210' y='30' width='30' height='20' rx='3' fill='%230d6efd' stroke='%23fff' stroke-width='1'/><text x='225' y='42' text-anchor='middle' font-family='Arial' font-size='8' fill='%23fff'>üîÑ</text><line x1='225' y1='55' x2='225' y2='65' stroke='%23ff6b6b' stroke-width='2'/><text x='235' y='75' font-family='Arial' font-size='6' fill='%23ff6b6b'>Refresh</text></svg>" alt="Sync archer list" class="w-full max-w-xs mx-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
        </div>
        
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-download"></i> Import from Master List</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Get the latest archer information and assignments</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-edit"></i> Add Missing Archers</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Add any archers who aren't in the master list</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-check"></i> Verify Information</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Make sure bale assignments and target letters are correct</p>
        </div>
        <div class="flex gap-3 justify-center mt-6">
          <button class="px-5 py-2.5 bg-gray-500 hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-700 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="prevStep()">Back</button>
          <button class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="nextStep()">Continue</button>
        </div>
      </div>

      <!-- Step 4: Start Scoring -->
      <div id="step-4" class="onboarding-step">
        <div class="flex justify-center gap-1 mb-4">
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600"></div>
          <div class="w-2.5 h-2.5 rounded-full bg-blue-600 dark:bg-blue-500"></div>
        </div>
        <h2 class="text-xl font-bold text-blue-600 dark:text-blue-400 mb-3">
          <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-600 dark:bg-blue-500 text-white text-sm mr-2">4</span>
          Start Scoring!
        </h2>
        <p class="text-gray-600 dark:text-gray-300 mb-4 text-sm leading-relaxed">You're all set! Choose the type of scoring you want to do:</p>
        
        <div class="text-center my-4">
          <img src="data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='250' height='180' viewBox='0 0 250 180'><rect width='250' height='180' fill='%23f8f9fa' stroke='%23dee2e6' stroke-width='1'/><text x='125' y='20' text-anchor='middle' font-family='Arial' font-size='12' fill='%23343a40'>üèÜ Ranking - E1</text><rect x='10' y='35' width='230' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='50' font-family='Arial' font-size='8' fill='%23343a40'>Sarah J</text><text x='70' y='50' font-family='Arial' font-size='8' fill='%23ffc107'>X</text><text x='95' y='50' font-family='Arial' font-size='8' fill='%23ffc107'>10</text><text x='120' y='50' font-family='Arial' font-size='8' fill='%23ffc107'>9</text><text x='145' y='50' font-family='Arial' font-size='8' fill='%23dc3545'>29</text><text x='170' y='50' font-family='Arial' font-size='8' fill='%230d6efd'>29</text><rect x='10' y='65' width='230' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='80' font-family='Arial' font-size='8' fill='%23343a40'>Mike C</text><text x='70' y='80' font-family='Arial' font-size='8' fill='%23ffc107'>9</text><text x='95' y='80' font-family='Arial' font-size='8' fill='%23ffc107'>9</text><text x='120' y='80' font-family='Arial' font-size='8' fill='%23ffc107'>8</text><text x='145' y='80' font-family='Arial' font-size='8' fill='%23dc3545'>26</text><text x='170' y='80' font-family='Arial' font-size='8' fill='%230d6efd'>26</text><rect x='10' y='95' width='230' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='110' font-family='Arial' font-size='8' fill='%23343a40'>Alex R</text><text x='70' y='110' font-family='Arial' font-size='8' fill='%23ffc107'>10</text><text x='95' y='110' font-family='Arial' font-size='8' fill='%23ffc107'>X</text><text x='120' y='110' font-family='Arial' font-size='8' fill='%23ffc107'>9</text><text x='145' y='110' font-family='Arial' font-size='8' fill='%23dc3545'>29</text><text x='170' y='110' font-family='Arial' font-size='8' fill='%230d6efd'>29</text><rect x='10' y='125' width='230' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='15' y='140' font-family='Arial' font-size='8' fill='%23343a40'>Emma D</text><text x='70' y='140' font-family='Arial' font-size='8' fill='%23ffc107'>8</text><text x='95' y='140' font-family='Arial' font-size='8' fill='%23ffc107'>8</text><text x='120' y='140' font-family='Arial' font-size='8' fill='%23ffc107'>7</text><text x='145' y='140' font-family='Arial' font-size='8' fill='%23dc3545'>23</text><text x='170' y='140' font-family='Arial' font-size='8' fill='%230d6efd'>23</text><rect x='10' y='155' width='110' height='25' rx='3' fill='%23fff' stroke='%23dee2e6' stroke-width='1'/><text x='65' y='170' text-anchor='middle' font-family='Arial' font-size='8' fill='%23343a40'>‚Üê E</text><rect x='130' y='155' width='110' height='25' rx='3' fill='%23198754' stroke='%23fff' stroke-width='1'/><text x='185' y='170' text-anchor='middle' font-family='Arial' font-size='8' fill='%23fff'>E ‚Üí</text><line x1='70' y1='50' x2='70' y2='50' stroke='%23ff6b6b' stroke-width='2'/><text x='80' y='45' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text><line x1='70' y1='80' x2='70' y2='80' stroke='%23ff6b6b' stroke-width='2'/><text x='80' y='75' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text><line x1='70' y1='110' x2='70' y2='110' stroke='%23ff6b6b' stroke-width='2'/><text x='80' y='105' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text><line x1='70' y1='140' x2='70' y2='140' stroke='%23ff6b6b' stroke-width='2'/><text x='80' y='135' font-family='Arial' font-size='6' fill='%23ff6b6b'>Tap</text></svg>" alt="Scoring interface" class="w-full max-w-xs mx-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
        </div>
        
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-trophy"></i> Ranking Round</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Score competitive ranking rounds with multiple archers</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-user-friends"></i> Solo Match</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Track a 1v1 match (first to 6 set points wins)</p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg my-3 border-l-4 border-blue-600 dark:border-blue-500">
          <h3 class="text-blue-600 dark:text-blue-400 font-semibold text-sm mb-1"><i class="fas fa-users-cog"></i> Team Match</h3>
          <p class="text-gray-600 dark:text-gray-300 text-xs">Score a team vs team match (first to 5 set points wins)</p>
        </div>
        <div class="flex gap-3 justify-center mt-6">
          <button class="px-5 py-2.5 bg-gray-500 hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-700 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="prevStep()">Back</button>
          <button class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md" onclick="completeOnboarding()">Let's Go!</button>
        </div>
      </div>
    </div>
  </div>

  <div class="w-full max-w-md mx-auto flex flex-col min-h-screen">
    <!-- Header with Dark Mode Toggle -->
    <header class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-bold text-gray-800 dark:text-white">Archery Tools</h1>
      <button id="dark-mode-toggle" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200" title="Toggle dark mode">
        <i class="fas fa-moon dark:hidden"></i>
        <i class="fas fa-sun hidden dark:inline"></i>
      </button>
    </header>

    <!-- Main Content -->
    <div class="flex-grow space-y-6">
      <!-- Archer Details Section -->
      <div class="space-y-3">
        <a href="archer_list.html" id="archer-details-btn" class="block w-full px-6 py-4 bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white rounded-lg font-semibold text-lg transition-all hover:-translate-y-0.5 shadow-lg text-center" title="Update your archer profile and details">
          <i class="fas fa-user-circle mr-2"></i>Archer Details
        </a>
        <div id="welcome-self" class="text-center"></div>
      </div>
      
      <!-- Open Assignments Section -->
      <div id="open-assignments" class="hidden space-y-3">
        <h2 class="text-xl font-bold text-gray-800 dark:text-white flex items-center">
          <i class="fas fa-tasks mr-2 text-blue-600 dark:text-blue-400"></i>
          Your Open Assignments
        </h2>
        <div id="assignments-list" class="space-y-2">
          <!-- Assignments will be populated here -->
        </div>
      </div>
      
      <!-- Main Modules -->
      <div class="grid grid-cols-2 gap-4">
        <a href="ranking_round_300.html" class="block px-4 py-4 bg-teal-600 hover:bg-teal-700 dark:bg-teal-500 dark:hover:bg-teal-600 text-white rounded-lg font-semibold transition-all hover:-translate-y-0.5 shadow-lg text-center" title="Score competitive ranking rounds with multiple archers">
          <i class="fas fa-trophy block mb-2 text-xl"></i>Ranking
        </a>
        <a href="solo_card.html" class="block px-4 py-4 bg-yellow-500 hover:bg-yellow-600 dark:bg-yellow-400 dark:hover:bg-yellow-500 text-gray-900 rounded-lg font-semibold transition-all hover:-translate-y-0.5 shadow-lg text-center" title="Track 1v1 matches (first to 6 set points wins)">
          <i class="fas fa-user-friends block mb-2 text-xl"></i>Solo
        </a>
        <a href="team_card.html" class="block px-4 py-4 bg-orange-500 hover:bg-orange-600 dark:bg-orange-400 dark:hover:bg-orange-500 text-gray-900 rounded-lg font-semibold transition-all hover:-translate-y-0.5 shadow-lg text-center" title="Score team vs team matches (first to 5 set points wins)">
          <i class="fas fa-users-cog block mb-2 text-xl"></i>Team
        </a>
        <a href="gemini-oneshot.html" class="block px-4 py-4 bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 text-white rounded-lg font-semibold transition-all hover:-translate-y-0.5 shadow-lg text-center" title="Practice sessions with arrow grouping analysis">
          <i class="fas fa-bullseye block mb-2 text-xl"></i>Practice
        </a>
      </div>
    </div>

    <!-- Footer -->
    <footer class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
      <div class="grid grid-cols-2 gap-3 mb-4">
        <a href="coach.html" class="block px-3 py-2.5 bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md text-center" title="Coach console: events and live scoring">
          <i class="fas fa-chalkboard-teacher block mb-1 text-base"></i>Coaches
        </a>
        <button id="clear-cache-btn" class="px-3 py-2.5 bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all hover:-translate-y-0.5 shadow-md text-center" title="Clear cached archers, events, and scoring data on this device">
          <i class="fas fa-broom block mb-1 text-base"></i>Reset Data
        </button>
      </div>
      <p class="text-center text-gray-600 dark:text-gray-400 text-xs">¬© 2025 OAS Score Sheets & Tools. All rights reserved.</p>
    </footer>
  </div>

  <script src="js/archer_module.js"></script>
  <script>
    // Onboarding functionality
    let currentStep = 1;
    const totalSteps = 4;

    // Check if this is the first visit
    function shouldShowOnboarding() {
      const hasVisited = localStorage.getItem('archery_tools_onboarding_complete');
      return !hasVisited;
    }

    function showOnboarding() {
      if (shouldShowOnboarding()) {
        document.getElementById('onboarding-modal').classList.remove('hidden');
      }
    }

    function nextStep() {
      if (currentStep < totalSteps) {
        document.getElementById(`step-${currentStep}`).classList.remove('active');
        currentStep++;
        document.getElementById(`step-${currentStep}`).classList.add('active');
        updateProgressDots();
      }
    }

    function prevStep() {
      if (currentStep > 1) {
        document.getElementById(`step-${currentStep}`).classList.remove('active');
        currentStep--;
        document.getElementById(`step-${currentStep}`).classList.add('active');
        updateProgressDots();
      }
    }

    function updateProgressDots() {
      const dots = document.querySelectorAll('.progress-dot');
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentStep - 1);
      });
    }

    function completeOnboarding() {
      localStorage.setItem('archery_tools_onboarding_complete', 'true');
      document.getElementById('onboarding-modal').classList.add('hidden');
    }

    function skipOnboarding() {
      localStorage.setItem('archery_tools_onboarding_complete', 'true');
      document.getElementById('onboarding-modal').classList.add('hidden');
    }

    // Load open assignments for the current archer
    async function loadOpenAssignments() {
      try {
        // Get current archer
        let archer = null;
        if (window.ArcherModule && typeof window.ArcherModule.getSelfArcher === 'function') {
          archer = window.ArcherModule.getSelfArcher();
        }
        
        if (!archer || !archer.id) {
          console.log('No archer set - cannot load assignments');
          return;
        }
        
        const assignments = [];
        
        // Check for open ranking rounds
        try {
          const historyRes = await fetch(`api/v1/archers/${archer.id}/history`);
          if (historyRes.ok) {
            const historyData = await historyRes.json();
            const rounds = historyData.rounds || [];
            
            // Find incomplete rounds (not locked, low score, or few ends)
            const openRounds = rounds.filter(round => {
              const isLocked = round.locked || round.card_status === 'VER';
              const hasLowScore = (round.final_score || 0) < 50;
              const hasIncompleteEnds = (round.ends_completed || 0) < 10;
              return !isLocked && (hasLowScore || hasIncompleteEnds);
            });
            
            openRounds.forEach(round => {
              assignments.push({
                type: 'ranking',
                title: round.event_name || 'Ranking Round',
                subtitle: `${round.round_type || 'R300'} ‚Ä¢ ${round.division || 'Unknown Division'}`,
                details: `Bale ${round.bale_number || '?'} ‚Ä¢ ${round.ends_completed || 0}/10 ends`,
                link: `ranking_round_300.html?event=${round.event_id}&round=${round.round_id}&archer=${archer.id}`,
                icon: 'fas fa-trophy',
                color: 'bg-teal-600 hover:bg-teal-700',
                urgent: (round.ends_completed || 0) > 0 // Has started but not finished
              });
            });
          }
        } catch (e) {
          console.log('Could not load ranking round history:', e.message);
        }
        
        // Check for active events (if accessible)
        try {
          const today = new Date().toISOString().slice(0, 10);
          const eventsRes = await fetch('api/v1/events/recent');
          if (eventsRes.ok) {
            const eventsData = await eventsRes.json();
            const events = eventsData.events || [];
            
            // Find active events for today
            const activeEvents = events.filter(ev => 
              ev.date === today && 
              (ev.status === 'Active' || ev.status === 'Not Started')
            );
            
            activeEvents.forEach(event => {
              assignments.push({
                type: 'event',
                title: event.name,
                subtitle: `Active Event ‚Ä¢ Today`,
                details: `Status: ${event.status}`,
                link: `ranking_round_300.html?event=${event.id}`,
                icon: 'fas fa-calendar-check',
                color: 'bg-blue-600 hover:bg-blue-700',
                urgent: event.status === 'Active'
              });
            });
          }
        } catch (e) {
          console.log('Could not load active events:', e.message);
        }
        
        // Display assignments
        const assignmentsSection = document.getElementById('open-assignments');
        const assignmentsList = document.getElementById('assignments-list');
        
        if (assignments.length === 0) {
          assignmentsSection.classList.add('hidden');
          return;
        }
        
        // Sort by urgency (urgent first)
        assignments.sort((a, b) => (b.urgent ? 1 : 0) - (a.urgent ? 1 : 0));
        
        assignmentsList.innerHTML = assignments.map(assignment => `
          <a href="${assignment.link}" class="block p-4 ${assignment.color} dark:${assignment.color.replace('bg-', 'bg-').replace('hover:bg-', 'hover:bg-')} text-white rounded-lg transition-all hover:-translate-y-0.5 shadow-lg">
            <div class="flex items-center">
              <i class="${assignment.icon} text-xl mr-3"></i>
              <div class="flex-1">
                <div class="font-semibold text-lg flex items-center">
                  ${assignment.title}
                  ${assignment.urgent ? '<span class="ml-2 px-2 py-1 bg-red-500 text-xs rounded-full animate-pulse">!</span>' : ''}
                </div>
                <div class="text-sm opacity-90">${assignment.subtitle}</div>
                <div class="text-xs opacity-75">${assignment.details}</div>
              </div>
              <i class="fas fa-chevron-right text-lg opacity-75"></i>
            </div>
          </a>
        `).join('');
        
        assignmentsSection.classList.remove('hidden');
        
      } catch (e) {
        console.log('Could not load open assignments:', e.message);
      }
    }

    function updateWelcomeMessage() {
      const welcomeEl = document.getElementById('welcome-self');
      if (!welcomeEl) return;
      try {
        let archer = null;
        
        // Try ArcherModule first
        if (window.ArcherModule && typeof window.ArcherModule.getSelfArcher === 'function') {
          archer = window.ArcherModule.getSelfArcher();
        }
        
        // Fallback to localStorage
        if (!archer) {
          const extId = localStorage.getItem('archerSelfExtId') || '';
          if (!extId) {
            welcomeEl.innerHTML = `<div class="text-sm text-gray-500 dark:text-gray-400 italic animate-pulse">üëÜ Tap above to update your details</div>`;
            return;
          }
          const listRaw = localStorage.getItem('archerList');
          if (listRaw) {
            try {
              const list = JSON.parse(listRaw) || [];
              archer = list.find(a => (a.extId || '') === extId || `${(a.first || '').trim()}-${(a.last || '').trim()}` === extId);
            } catch (_) {}
          }
        }
        
        if (archer) {
          const nickname = archer.nickname ? ` "${archer.nickname}"` : '';
          const initials = (archer.first.charAt(0) + archer.last.charAt(0)).toUpperCase();
          
          // Build avatar HTML
          let avatarHTML = '';
          if (archer.photoUrl) {
            avatarHTML = `<img src="${archer.photoUrl}" alt="${archer.first} ${archer.last}" class="w-20 h-20 rounded-full object-cover border-4 border-white dark:border-gray-700 shadow-lg">`;
          } else {
            avatarHTML = `<div class="w-20 h-20 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center border-4 border-white dark:border-gray-700 shadow-lg"><span class="text-2xl font-bold text-white">${initials}</span></div>`;
          }
          
          welcomeEl.innerHTML = `
            <div class="flex flex-col items-center gap-3">
              ${avatarHTML}
              <div class="text-2xl font-bold text-gray-800 dark:text-white">${archer.first} ${archer.last}${nickname}</div>
            </div>
          `;
        } else {
          welcomeEl.innerHTML = `<div class="text-sm text-gray-500 dark:text-gray-400 italic animate-pulse">üëÜ Tap above to update your details</div>`;
        }
      } catch (e) {
        console.warn('Unable to render welcome message:', e);
      }
    }

    async function clearAppData() {
      const confirmed = confirm('Reset local app data? This clears cached archers, events, and scoring sessions stored on this device.');
      if (!confirmed) return;

      const exactKeys = [
        'archerList',
        'archerListMeta',
        'archerListPendingUpserts',
        'archerSelfExtId',
        'live_updates_config',
        'coach_api_key',
        'event_entry_code',
        'archery_master_list',
        'archery_tools_onboarding_complete'
      ];
      const keyPrefixes = [
        'rankingRound_',
        'rankingRound300_',
        'event:',
        'LiveUpdates:',
        'cachedRound:',
        'coachSession:',
        'manualBale:'
      ];

      try {
        const keys = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (!key) continue;
          keys.push(key);
        }
        keys.forEach(key => {
          if (exactKeys.includes(key) || keyPrefixes.some(prefix => key.startsWith(prefix))) {
            localStorage.removeItem(key);
          }
        });
      } catch (err) {
        console.warn('Local storage clear failed:', err);
      }

      try { sessionStorage.clear(); } catch (err) { console.warn('Session storage clear failed:', err); }

      if (window.caches && typeof window.caches.keys === 'function') {
        try {
          const cacheNames = await window.caches.keys();
          await Promise.all(cacheNames.map(name => window.caches.delete(name)));
        } catch (err) {
          console.warn('Cache API clear failed:', err);
        }
      }

      // Clear cookies - explicitly delete known cookies with multiple paths/domains
      const knownCookies = ['oas_archer_id', 'coach_auth'];
      const paths = ['/', '/wdv', '/wdv/'];
      const domains = [window.location.hostname, '.' + window.location.hostname, ''];
      
      try {
        // First, explicitly clear known cookies with all path/domain combinations
        knownCookies.forEach(cookieName => {
          paths.forEach(path => {
            domains.forEach(domain => {
              if (domain) {
                document.cookie = `${cookieName}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=${path};domain=${domain}`;
              } else {
                document.cookie = `${cookieName}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=${path}`;
              }
            });
          });
        });
        
        // Then, clear all other cookies visible in document.cookie
        document.cookie.split(';').forEach(cookieStr => {
          const cookie = cookieStr.trim();
          if (!cookie) return;
          const eqPos = cookie.indexOf('=');
          const name = eqPos > -1 ? cookie.substring(0, eqPos) : cookie;
          if (!name) return;
          // Try multiple paths to ensure deletion
          paths.forEach(path => {
            document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=${path}`;
          });
        });
      } catch (err) {
        console.warn('Cookie clear failed:', err);
      }

      // Clear IndexedDB if it exists
      if (window.indexedDB && window.indexedDB.databases) {
        try {
          const databases = await window.indexedDB.databases();
          await Promise.all(databases.map(db => {
            return new Promise((resolve, reject) => {
              const deleteReq = window.indexedDB.deleteDatabase(db.name);
              deleteReq.onsuccess = () => resolve();
              deleteReq.onerror = () => reject(deleteReq.error);
              deleteReq.onblocked = () => resolve(); // Resolve anyway if blocked
            });
          }));
        } catch (err) {
          console.warn('IndexedDB clear failed:', err);
        }
      }

      alert('Local app data cleared. The page will reload now.');
      // Force hard reload to clear page cache (bypass cache)
      // Using href assignment with timestamp to force cache bypass
      window.location.href = window.location.pathname + '?nocache=' + Date.now();
    }

    // Onboarding disabled - outdated tutorial
    document.addEventListener('DOMContentLoaded', function() {
      // showOnboarding(); // DISABLED - Tutorial needs updating
      // Note: Active event banner disabled - requires authentication that archers don't have

      const clearBtn = document.getElementById('clear-cache-btn');
      if (clearBtn) {
        clearBtn.addEventListener('click', () => {
          clearAppData();
        });
      }

      updateWelcomeMessage();
      loadOpenAssignments();
      
      // Dark mode toggle functionality
      const darkModeToggle = document.getElementById('dark-mode-toggle');
      if (darkModeToggle) {
        // Check for saved dark mode preference or default to light mode
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        }
        
        darkModeToggle.addEventListener('click', () => {
          document.documentElement.classList.toggle('dark');
          const isDark = document.documentElement.classList.contains('dark');
          localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
      }
    });
  </script>
</body>
</html>

